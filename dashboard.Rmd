---
title: "NY NOAA Weather Data Analysis"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(plotly)
library(p8105.datasets)
library(knitr)
library(tidyverse)
```

```{r}
data(ny_noaa)
```

```{r}
ny_noaa <- ny_noaa |>
  mutate(
    across(c(prcp, snow, snwd, tmax, tmin), ~as.numeric(.))
  )

ny_noaa_clean <- ny_noaa |> 
mutate(
date = as.Date(date),
year = year(date),
month = month(date),

prcp_mm = ifelse(!is.na(prcp), prcp / 10, NA_real_), 
tmax_c = ifelse(!is.na(tmax), tmax / 10, NA_real_), 
tmin_c = ifelse(!is.na(tmin), tmin / 10, NA_real_),
tavg_c = ifelse(!is.na(tmax) & !is.na(tmin), (tmax/10 + tmin/10)/2, NA_real_)
) |> 
select(id, date, year, month, prcp_mm, snow, snwd, tmax_c, tmin_c, tavg_c)

# Identify stations with temperature coverage
station_coverage <- ny_noaa_clean |> 
summarise(
.by = c(id, year),
n_days = dplyr::n(),
n_tmax = sum(!is.na(tmax_c)),
n_tmin = sum(!is.na(tmin_c)),
n_prcp = sum(!is.na(prcp_mm))
) |> 
mutate(
has_temp = n_tmax >= 150 & n_tmin >= 150, # heuristic: ~>= 5 months
has_prcp = n_prcp >= 150
)

stations_temp_any <- station_coverage |> 
summarise(.by = id, has_temp_any = any(has_temp)) |> 
filter(has_temp_any) |>  pull(id)

stations_prcp_any <- station_coverage |> 
summarise(.by = id, has_prcp_any = any(has_prcp)) |> 
filter(has_prcp_any) |>  pull(id)

ny_noaa_clean

```


Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}

```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

